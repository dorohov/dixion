"use strict";!function(){var t,i="azbn.",e={set:function(t,e){localStorage.setItem(i+t,e)},get:function(t){var e=localStorage.getItem(i+t);return"undefined"!=typeof e&&null!=e?e:null},remove:function(t){localStorage.removeItem(i+t)},clear:function(){localStorage.clear()},obj2s:function(t,i){this.set(t,JSON.stringify(i))},s2obj:function(t){var i=this.get(t);return"undefined"!=typeof i&&null!=i?JSON.parse(i):null}},a={prefix:"dixion.cart.",lscart_uid:function(){return this.prefix+"services"},set:function(t,i){var a=e.s2obj(this.lscart_uid());t.material=0,t.size=0,t.color=0,null!=a||(a={}),a[t.id]||(a[t.id]={}),a[t.id][t.material]||(a[t.id][t.material]={}),a[t.id][t.material][t.size]||(a[t.id][t.material][t.size]={}),a[t.id][t.material][t.size][t.color]={id:t.id,title:t.title,qty:i,cost1:t.cost1?parseFloat(""+t.cost1):a[t.id][t.material][t.size][t.color].cost1,cost2:t.cost2?parseFloat(""+t.cost2):""},e.obj2s(this.lscart_uid(),a)},getQty:function(t){var i=e.s2obj(this.lscart_uid());t.material=0,t.size=0,t.color=0,null!=i||(i={});var a=0;return a=i[t.id]&&i[t.id][t.material]&&i[t.id][t.material][t.size]&&i[t.id][t.material][t.size][t.color]?i[t.id][t.material][t.size][t.color].qty:a,parseInt(a)},getAll:function(){var t=e.s2obj(this.lscart_uid());null!=t||(t={});var i=0,a=0;for(var r in t)!function(t){for(var e in t)!function(t){for(var e in t)!function(t){for(var e in t)i+=t[e].qty,a+=t[e].qty*t[e].cost}(t[e])}(t[e])}(t[r]);return{qty:i,sum:a}},iterAll:function(t,i){var a=e.s2obj(this.lscart_uid());null!=a||(a={});var r=0,n=0;for(var o in a)!function(i){for(var e in i)!function(i){for(var e in i)!function(i){for(var e in i)n+=i[e].qty,r+=i[e].qty*i[e].cost1,t({id:o,title:i[e].title,qty:i[e].qty,cost1:i[e].cost1,cost2:i[e].cost2})}(i[e])}(i[e])}(a[o]);i(r,n)},del:function(t){var i=e.s2obj(this.lscart_uid());t.material=0,t.size=0,t.color=0,null!=i||(i={}),i[t.id]&&i[t.id][t.material]&&i[t.id][t.material][t.size]&&i[t.id][t.material][t.size][t.color]&&(i[t.id][t.material][t.size][t.color]=null,delete i[t.id][t.material][t.size][t.color],e.obj2s(this.lscart_uid(),i))},clear:function(){e.obj2s(this.lscart_uid(),{})}},r=function(i){var e=t.clone(!0);return e.attr("data-service-id",i.id).attr("data-service-cost1",i.cost1).attr("data-service-cost2",i.cost2),e.find(".azbn__incart-item__title").html(i.title),e.find(".azbn__incart-item__cost1").html(i.cost1),e.find(".azbn__incart-item__cost2").html(i.cost2?"/ "+i.cost2:""),e};$(function(){var i=$(".price-list-page");if(i.length){var e=$(".azbn__incart-items");t=e.find(".azbn__incart-item_ideal"),t.length&&($(document.body).on("azbn.cart.recalc",null,{},function(t){a.iterAll(function(t){r(t).appendTo(e)},function(t,i){$(".azbn__incart-sum").html(t),$(".azbn__incart-qty").html(i)})}),$(document.body).on("click.azbn",".azbn__service-item__add",{},function(t){var i=$(this),r=i.closest(".azbn__service-item"),n=parseInt(r.attr("data-service-id"));a.set({id:n,title:r.attr("data-service-title"),cost1:parseFloat(r.attr("data-service-cost1")),cost2:r.attr("data-service-cost2")||""},1),e.empty(),$(document.body).trigger("azbn.cart.recalc")}),$(document.body).on("click.azbn",".azbn__incart-item__delete",{},function(t){var i=$(this),r=i.closest(".azbn__incart-item"),n=parseInt(r.attr("data-service-id"));a.del({id:n}),e.empty(),$(document.body).trigger("azbn.cart.recalc")}),t.detach(),e.empty(),$(document.body).trigger("azbn.cart.recalc"))}$(document.body).on("submit",".azbn-api-formsave",{},function(t){t.preventDefault();var i=$(this),e=i.clone(!0),a=i.attr("data-method")||"formsave";e.append($("<input/>",{type:"hidden",name:"method",value:a})),$.post("/api/",e.serialize(),function(t){t=JSON.parse(t),e.empty().remove(),i.trigger("reset"),i.closest(".modal").modal("hide"),$(".azbn-api-formsave-result").html(t.response.message.text),$("#modal-message-formsave-result").modal()})}),$(document.body).on("click",".azbn-specialist-order-btn",{},function(t){var i=$(this),e=i.attr("data-specialist-name")||"";$("#modal-appointment input.azbn-form-editable").val(e)}),$(document.body).on("click",".azbn-service-program-order-btn",{},function(t){var i=$(this),e=i.attr("data-service-program")||"";$("#modal-order input.azbn-form-editable").val(e)})})}();