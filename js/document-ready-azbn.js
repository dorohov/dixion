"use strict";!function(){var t,a="azbn.",i={set:function(t,i){localStorage.setItem(a+t,i)},get:function(t){var i=localStorage.getItem(a+t);return"undefined"!=typeof i&&null!=i?i:null},remove:function(t){localStorage.removeItem(a+t)},clear:function(){localStorage.clear()},obj2s:function(t,a){this.set(t,JSON.stringify(a))},s2obj:function(t){var a=this.get(t);return"undefined"!=typeof a&&null!=a?JSON.parse(a):null}},e={prefix:"dixion.cart.",lscart_uid:function(){return this.prefix+"services"},set:function(t,a){var e=i.s2obj(this.lscart_uid());t.material=0,t.size=0,t.color=0,null!=e||(e={}),e[t.id]||(e[t.id]={}),e[t.id][t.material]||(e[t.id][t.material]={}),e[t.id][t.material][t.size]||(e[t.id][t.material][t.size]={}),e[t.id][t.material][t.size][t.color]={id:t.id,title:t.title,qty:a,cost1:t.cost1?parseFloat(""+t.cost1):e[t.id][t.material][t.size][t.color].cost1,cost2:t.cost2?parseFloat(""+t.cost2):""},i.obj2s(this.lscart_uid(),e)},getQty:function(t){var a=i.s2obj(this.lscart_uid());t.material=0,t.size=0,t.color=0,null!=a||(a={});var e=0;return e=a[t.id]&&a[t.id][t.material]&&a[t.id][t.material][t.size]&&a[t.id][t.material][t.size][t.color]?a[t.id][t.material][t.size][t.color].qty:e,parseInt(e)},getAll:function(){var t=i.s2obj(this.lscart_uid());null!=t||(t={});var a=0,e=0;for(var r in t)!function(t){for(var i in t)!function(t){for(var i in t)!function(t){for(var i in t)a+=t[i].qty,e+=t[i].qty*t[i].cost}(t[i])}(t[i])}(t[r]);return{qty:a,sum:e}},iterAll:function(t,a){var e=i.s2obj(this.lscart_uid());null!=e||(e={});var r=0,o=0;for(var n in e)!function(a){for(var i in a)!function(a){for(var i in a)!function(a){for(var i in a)o+=a[i].qty,r+=a[i].qty*a[i].cost1,t({id:n,title:a[i].title,qty:a[i].qty,cost1:a[i].cost1,cost2:a[i].cost2})}(a[i])}(a[i])}(e[n]);a(r,o)},del:function(t){var a=i.s2obj(this.lscart_uid());t.material=0,t.size=0,t.color=0,null!=a||(a={}),a[t.id]&&a[t.id][t.material]&&a[t.id][t.material][t.size]&&a[t.id][t.material][t.size][t.color]&&(a[t.id][t.material][t.size][t.color]=null,delete a[t.id][t.material][t.size][t.color],i.obj2s(this.lscart_uid(),a))},clear:function(){i.obj2s(this.lscart_uid(),{})}},r=function(a){var i=t.clone(!0);return i.attr("data-service-id",a.id).attr("data-service-cost1",a.cost1).attr("data-service-cost2",a.cost2),i.find(".azbn__incart-item__title").html(a.title),i.find(".azbn__incart-item__cost1").html(a.cost1),i.find(".azbn__incart-item__cost2").html(a.cost2?"/ "+a.cost2:""),i};$(function(){var a=$(".price-list-page");if(a.length){var i=$(".azbn__incart-items");t=i.find(".azbn__incart-item_ideal"),t.length&&($(document.body).on("azbn.cart.recalc",null,{},function(t){e.iterAll(function(t){r(t).appendTo(i)},function(t,a){$(".azbn__incart-sum").html(t),$(".azbn__incart-qty").html(a)})}),$(document.body).on("click.azbn",".azbn__service-item__add",{},function(t){var a=$(this),r=a.closest(".azbn__service-item"),o=parseInt(r.attr("data-service-id"));e.set({id:o,title:r.attr("data-service-title"),cost1:parseFloat(r.attr("data-service-cost1")),cost2:r.attr("data-service-cost2")||""},1),i.empty(),$(document.body).trigger("azbn.cart.recalc")}),$(document.body).on("click.azbn",".azbn__incart-item__delete",{},function(t){var a=$(this),r=a.closest(".azbn__incart-item"),o=parseInt(r.attr("data-service-id"));e.del({id:o}),i.empty(),$(document.body).trigger("azbn.cart.recalc")}),t.detach(),i.empty(),$(document.body).trigger("azbn.cart.recalc"))}$(document.body).on("submit",".azbn-api-formsave",{},function(t){t.preventDefault();var a=$(this),i=a.clone(!0),e=a.attr("data-method")||"formsave";i.append($("<input/>",{type:"hidden",name:"method",value:e})),$.post("/api/",i.serialize(),function(t){t=JSON.parse(t),i.empty().remove(),a.trigger("reset"),a.closest(".modal").modal("hide"),$(".azbn-api-formsave-result").html(t.response.message.text),$("#modal-message-formsave-result").modal()})}),$(document.body).on("click",".azbn-specialist-order-btn",{},function(t){var a=$(this),i=a.attr("data-specialist-name")||"";$("#modal-appointment input.azbn-form-editable").val(i)}),$(document.body).on("click",".azbn-service-program-order-btn",{},function(t){var a=$(this),i=a.attr("data-service-program")||"";$("#modal-order input.azbn-form-editable").val(i)}),$(document.body).on("click","svg polygon.azbn-tour-polygon",{},function(t){var a=$(this),i=a.attr("data-room-preview")||"",e=a.attr("data-room-name")||"";$(".azbn-tour-image").css({"background-image":"url("+i+")"}),$(".azbn-tour-title").html(e)}),$("svg polygon.azbn-tour-polygon").eq(0).trigger("click")})}();